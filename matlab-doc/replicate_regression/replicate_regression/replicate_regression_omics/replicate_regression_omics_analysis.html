<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of replicate_regression_omics_analysis</title>
  <meta name="keywords" content="replicate_regression_omics_analysis">
  <meta name="description" content="Script replicate_regression_omics_analysis">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">replicate_regression</a> &gt; <a href="#">replicate_regression</a> &gt; <a href="#">replicate_regression_omics</a> &gt; replicate_regression_omics_analysis.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for ./replicate_regression/replicate_regression/replicate_regression_omics&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>replicate_regression_omics_analysis
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Script replicate_regression_omics_analysis</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Script replicate_regression_omics_analysis

 Run replicate regression analysis for an omics dataset
 and save all results and graphics to files

 Input: 
 base_DIR      (directory path for data set, to be referred to in options file]
 foptions_file (filename of options file containing information 
                       about all further filenames, parameters, etc.)

 This script can also be run in a shell:

 matlab -r &quot;cd [DIRECTORY]; foptions_file = '[OPTIONS_FILENAME]'; replicate_regression_omics_analysis; quit;&quot;

 [DIRECTORY] is the directory in which this script is located
 The omics data filename is given in the options file</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././replicate_regression/replicate_regression/replicate_regression/biotable_interpolation_graphics_std.html" class="code" title="function biotable_interpolation_graphics_std(combined,averaged,replicate_averaged,p,ind_show,outfile);">biotable_interpolation_graphics_std</a>	</li><li><a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_complete.html" class="code" title="function [data_reg, options_complete, options_update] = replicate_regression_complete(data_replicates,options,foptions)">replicate_regression_complete</a>	[data_reg, options_complete, options_update] = replicate_regression_complete(data_replicates,options)</li><li><a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_display_statistics.html" class="code" title="function replicate_regression_display_statistics( result, options, filename,image_format)">replicate_regression_display_statistics</a>	replicate_regression_display_statistics( result, options, filename,image_format)</li><li><a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_load_data_table.html" class="code" title="function [data_replicates, data, data_pointwise_average, explanatory_variable,d] = replicate_regression_load_data_table(filename, foptions)">replicate_regression_load_data_table</a>	[data, data_replicates, data_pointwise_average, explanatory_variable] = replicate_regression_load_data_table(filename, foptions)</li><li><a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_save_data_table.html" class="code" title="function all = replicate_regression_save_data_table(data_table, rep_name, basename)">replicate_regression_save_data_table</a>	all = replicate_regression_save_data_table(data_table, rep_name, basename)</li><li><a href="../../.././replicate_regression/replicate_regression/utils/ca.html" class="code" title="function ca()">ca</a>	</li><li><a href="../../.././replicate_regression/replicate_regression/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>	commandstring = default(varname1,defaultvalue1,varname2,defaultvalue2,...)</li><li><a href="../../.././replicate_regression/replicate_regression/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>	c = join_struct(a,b)</li><li><a href="../../.././replicate_regression/replicate_regression/utils/load_options_table.html" class="code" title="function GreatBigOptions = load_options_table(tablefile,base_DIR)">load_options_table</a>	tablefile can be th ename of the table file</li><li><a href="../../.././replicate_regression/replicate_regression/utils/save_options_table.html" class="code" title="function my_table = save_options_table(options,tablefile)">save_options_table</a>	my_table = save_options_table(options,tablefile)</li><li><a href="../../.././replicate_regression/replicate_regression_BASEDIR.html" class="code" title="function d = replicate_regression_BASEDIR()">replicate_regression_BASEDIR</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../.././replicate_regression/demo/omics_data_example/omics_data_example.html" class="code" title="">omics_data_example</a>	-----------------------------------------------------------------------------------------------------------</li><li><a href="../../.././replicate_regression/demo/omics_data_example_ORIGINAL/omics_data_example.html" class="code" title="">omics_data_example</a>	-----------------------------------------------------------------------------------------------------------</li><li><a href="../../.././replicate_regression/replicate_regression_omics.html" class="code" title="function replicate_regression_omics(data_file, foptions_file, base_directory, goptions_file)">replicate_regression_omics</a>	replicate_regression_omics(data_file, foptions_file, base_directory)</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <span class="comment">% Script replicate_regression_omics_analysis</span>
0002 <span class="comment">%</span>
0003 <span class="comment">% Run replicate regression analysis for an omics dataset</span>
0004 <span class="comment">% and save all results and graphics to files</span>
0005 <span class="comment">%</span>
0006 <span class="comment">% Input:</span>
0007 <span class="comment">% base_DIR      (directory path for data set, to be referred to in options file]</span>
0008 <span class="comment">% foptions_file (filename of options file containing information</span>
0009 <span class="comment">%                       about all further filenames, parameters, etc.)</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% This script can also be run in a shell:</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% matlab -r &quot;cd [DIRECTORY]; foptions_file = '[OPTIONS_FILENAME]'; replicate_regression_omics_analysis; quit;&quot;</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% [DIRECTORY] is the directory in which this script is located</span>
0016 <span class="comment">% The omics data filename is given in the options file</span>
0017 
0018 eval(<a href="../../.././replicate_regression/replicate_regression/utils/default.html" class="code" title="function commandstring = default(varargin)">default</a>(<span class="string">'base_DIR'</span>,<span class="string">'[]'</span>));
0019 
0020 <span class="comment">% -------------------------------------------------------------------</span>
0021 <span class="comment">% load options</span>
0022 
0023 foptions_default = struct(<span class="keyword">...</span>
0024 <span class="string">'convenience_name'</span>, [], <span class="keyword">...</span>
0025     <span class="string">'translation_table_file'</span>, [<a href="../../.././replicate_regression/replicate_regression_BASEDIR.html" class="code" title="function d = replicate_regression_BASEDIR()">replicate_regression_BASEDIR</a> <span class="string">'/resources/SubtiWiki_id_mapping_20090701_renamed.txt'</span>], <span class="keyword">...</span>
0026     <span class="string">'data_scale'</span>,[], <span class="keyword">...</span>
0027     <span class="string">'convert_to_logarithm'</span>,[],<span class="keyword">...</span>
0028     <span class="string">'log_transformation'</span>,<span class="string">'arithmetic'</span>,<span class="keyword">...</span>
0029     <span class="string">'data_time_unit'</span>,<span class="string">'min'</span>,<span class="keyword">...</span>
0030     <span class="string">'data_min_data_points'</span>,3,<span class="keyword">...</span>
0031     <span class="string">'fixed_prior'</span>,0,<span class="keyword">...</span>
0032     <span class="string">'prior_updating'</span>,5,<span class="keyword">...</span>
0033     <span class="string">'update_prior_means'</span>,0,<span class="keyword">...</span>
0034     <span class="string">'run_crossvalidation'</span>,1,<span class="keyword">...</span>
0035     <span class="string">'postprocess_normalise'</span>,0,<span class="keyword">...</span>
0036     <span class="string">'graphics_format'</span>,<span class="string">'png'</span>,<span class="keyword">...</span>
0037     <span class="string">'graphics_scale'</span>,<span class="string">'linear'</span>,<span class="keyword">...</span>
0038     <span class="string">'data_file_csv'</span>,[],<span class="keyword">...</span>
0039     <span class="string">'result_file_matlab'</span>,[],<span class="keyword">...</span>
0040     <span class="string">'t_smooth'</span>,[],<span class="keyword">...</span>
0041     <span class="string">'regression_t_interp'</span>,[],<span class="keyword">...</span>
0042     <span class="string">'regression_tmin'</span>,[],<span class="keyword">...</span>
0043     <span class="string">'regression_tmax'</span>,[],<span class="keyword">...</span>
0044     <span class="string">'options_start_value'</span>,[],<span class="keyword">...</span>
0045     <span class="string">'options_start_at_t'</span>,[],<span class="keyword">...</span>
0046     <span class="string">'options_constant_before_start'</span>,[],<span class="keyword">...</span>
0047     <span class="string">'updating_factor'</span>,[],<span class="keyword">...</span>
0048     <span class="string">'options_out_csv'</span>,[],<span class="keyword">...</span>
0049     <span class="string">'result_file_csv'</span>,[],<span class="keyword">...</span>
0050     <span class="string">'graphics_file'</span>,[],<span class="keyword">...</span>
0051     <span class="string">'log_file'</span>,[],<span class="keyword">...</span>
0052     <span class="string">'graphics_individual'</span>,[],<span class="keyword">...</span>
0053     <span class="string">'result_file_zip'</span>,[],<span class="keyword">...</span>
0054     <span class="string">'normalise_by_median'</span>,1,<span class="keyword">...</span>
0055     <span class="string">'ignore_std_deviations'</span>,1,<span class="keyword">...</span>
0056     <span class="string">'data_min_num_replicates'</span>,1,<span class="keyword">...</span>
0057     <span class="string">'data_std_log'</span>,0.17,<span class="keyword">...</span>
0058     <span class="string">'data_outliers_threshold'</span>,1.5,<span class="keyword">...</span>
0059     <span class="string">'data_std_log_outlier'</span>,0.7,<span class="keyword">...</span>
0060     <span class="string">'data_std_minimal'</span>,10^-5,<span class="keyword">...</span>
0061     <span class="string">'mark_outliers_percentage'</span>,0.02);
0062 
0063 <span class="comment">% default values for data_std_log, data_outliers_threshold, data_std_log_outlier are for proteome data on log2 scale</span>
0064 
0065 foptions = <a href="../../.././replicate_regression/replicate_regression/utils/load_options_table.html" class="code" title="function GreatBigOptions = load_options_table(tablefile,base_DIR)">load_options_table</a>(foptions_file, base_DIR);
0066 foptions = <a href="../../.././replicate_regression/replicate_regression/utils/join_struct.html" class="code" title="function c = join_struct(a,b)">join_struct</a>(foptions_default,foptions);
0067 
0068 <span class="comment">% -------------------------------------------------------------------</span>
0069 <span class="comment">% Translate data tables (.csv files) into matlab structures and save them as a .mat file</span>
0070 <span class="comment">%</span>
0071 <span class="comment">% If necessary, replace (missing/all) standard deviations</span>
0072 <span class="comment">% sigma: Relative measurement error width (according to tests with BaSysBio data)</span>
0073 <span class="comment">%        value 0.3: personal communication J. Muntel</span>
0074 <span class="comment">%        my own calculation 0.18 (from duplicate data)</span>
0075 
0076 cd(foptions.data_dir);
0077 
0078 <span class="keyword">if</span> length(foptions.data_file_csv),
0079   [data_replicates, data, data_pointwise_average, explanatory_variable] = <a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_load_data_table.html" class="code" title="function [data_replicates, data, data_pointwise_average, explanatory_variable,d] = replicate_regression_load_data_table(filename, foptions)">replicate_regression_load_data_table</a>(foptions.data_file_csv, foptions);
0080   <span class="comment">%% only data_replicates is used for the regression</span>
0081   
0082   save(foptions.data_file_matlab, <span class="string">'data'</span>, <span class="string">'data_replicates'</span>, <span class="string">'data_pointwise_average'</span>,<span class="string">'explanatory_variable'</span>);
0083   display(sprintf(<span class="string">'Saved data to file %s'</span>, foptions.data_file_matlab));
0084 <span class="keyword">end</span>
0085 
0086 
0087 <span class="comment">% ----------------------------------------------------------------</span>
0088 <span class="comment">% Run replicate regression (entire omics data set)</span>
0089 <span class="comment">% use m-file 'biotable_combine_replicates' (data provided in 'biotable' data format)</span>
0090 
0091 <span class="keyword">if</span> length(foptions.result_file_matlab),
0092 
0093   cd(foptions.data_dir);  
0094   load(foptions.data_file_matlab);
0095   options = <a href="../../.././replicate_regression/replicate_regression/utils/load_options_table.html" class="code" title="function GreatBigOptions = load_options_table(tablefile,base_DIR)">load_options_table</a>(foptions.options_file);
0096 
0097   <span class="keyword">if</span> length(foptions.regression_t_interp),
0098     options.t_interp = foptions.regression_t_interp;
0099   <span class="keyword">elseif</span> length(foptions.regression_tmax),
0100     <span class="keyword">if</span> ~length(foptions.regression_tmin), foptions.tmin = 0; <span class="keyword">end</span>
0101     options.t_interp = foptions.regression_tmin + [foptions.regression_tmax - foptions.regression_tmin] *[0:0.05:1];
0102   <span class="keyword">else</span>,
0103     options.t_interp = [];
0104   <span class="keyword">end</span>  
0105   
0106   options.run_crossvalidation = foptions.run_crossvalidation; 
0107 
0108   <span class="keyword">if</span> length(foptions.options_start_at_t),  options.start_at_t  = foptions.options_start_at_t;  <span class="keyword">end</span> 
0109   <span class="keyword">if</span> length(foptions.options_start_value), options.start_value = foptions.options_start_value; <span class="keyword">end</span> 
0110   <span class="keyword">if</span> length(foptions.updating_factor),     options.updating_factor = foptions.updating_factor; <span class="keyword">end</span> 
0111   <span class="keyword">if</span> length(foptions.prior_updating),      options.prior_updating  = foptions.prior_updating;  <span class="keyword">end</span>
0112   <span class="keyword">if</span> length(foptions.t_smooth),            options.t_smooth        = foptions.t_smooth;        <span class="keyword">end</span>
0113   <span class="keyword">if</span> foptions.fixed_prior,                 options.prior_updating = 0; <span class="keyword">end</span>
0114   <span class="keyword">if</span> length(foptions.options_constant_before_start), 
0115     options.constant_before_start = foptions.options_constant_before_start; 
0116   <span class="keyword">end</span> 
0117 
0118   <span class="keyword">if</span> foptions.postprocess_normalise * [1-strcmp(options.basis,<span class="string">'sin_half'</span>)], 
0119     warning(<span class="string">'Normalisation is not possible'</span>); 
0120   <span class="keyword">end</span>
0121   <span class="keyword">if</span> length(foptions.convert_to_logarithm),
0122     options.convert_to_logarithm = foptions.convert_to_logarithm; 
0123   <span class="keyword">end</span>
0124   <span class="keyword">if</span> [foptions.postprocess_normalise * strcmp(foptions.data_scale,<span class="string">'absolute'</span>)], 
0125     options.convert_to_logarithm = 1; 
0126     display(<span class="string">'Switching to log scale'</span>);
0127   <span class="keyword">end</span>
0128 
0129   options.set_std =   foptions.set_std;
0130   
0131   [data_reg, options_complete, options_update] = <a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_complete.html" class="code" title="function [data_reg, options_complete, options_update] = replicate_regression_complete(data_replicates,options,foptions)">replicate_regression_complete</a>(data_replicates,options,foptions);
0132 
0133   <span class="keyword">if</span> foptions.run_crossvalidation,
0134 
0135   crossvalidation_error_mcr_replicate = nanmean([data_reg.combined.DataMean(:) - data_reg.crossvalidation_replicate.DataMean(:)].^2);
0136   crossvalidation_error_mcr_average   = nanmean([data_reg.combined.DataMean(:) - data_reg.crossvalidation_average.DataMean(:)].^2);
0137   crossvalidation_error_pooled        = nanmean([data_reg.combined.DataMean(:) - data_reg.pooled_crossvalidation.DataMean(:)].^2);
0138   crossvalidation_error_naive         = nanmean([data_reg.combined.DataMean(:) - data_reg.naive_crossvalidation.DataMean(:)].^2);
0139   <span class="keyword">else</span>
0140     crossvalidation_error_mcr_replicate = [];
0141     crossvalidation_error_mcr_average=[];
0142     crossvalidation_error_pooled = [];
0143     crossvalidation_error_naive = [];
0144   <span class="keyword">end</span>
0145   
0146   cd(foptions.result_dir);
0147 
0148   save(foptions.result_file_matlab, <span class="string">'data_reg'</span>, <span class="string">'options'</span>, <span class="string">'options_complete'</span>, <span class="string">'options_update'</span>, <span class="string">'crossvalidation_error_mcr_average'</span>,<span class="string">'crossvalidation_error_mcr_replicate'</span>, <span class="string">'crossvalidation_error_pooled'</span>, <span class="string">'crossvalidation_error_naive'</span>);
0149   display(sprintf(<span class="string">'Saved regression results to file %s'</span>, foptions.result_file_matlab));
0150 
0151 <span class="keyword">end</span>
0152 
0153 
0154 <span class="comment">% ------------------------------------------------</span>
0155 <span class="comment">% Show crossvalidation errors</span>
0156 
0157 <span class="keyword">if</span> length(crossvalidation_error_mcr_replicate),
0158   crossvalidation_error_mcr_replicate
0159   crossvalidation_error_mcr_average
0160   crossvalidation_error_pooled
0161   crossvalidation_error_naive
0162 <span class="keyword">end</span>
0163 
0164 <span class="comment">% ------------------------------------------------</span>
0165 <span class="comment">% Write results to table files</span>
0166 
0167 <span class="keyword">if</span> length(foptions.options_out_csv),
0168   cd(foptions.result_dir); 
0169   <a href="../../.././replicate_regression/replicate_regression/utils/save_options_table.html" class="code" title="function my_table = save_options_table(options,tablefile)">save_options_table</a>(options_complete, [foptions.options_out_csv ]);
0170   display(sprintf(<span class="string">'Saving updated options to file %s'</span>, [ foptions.options_out_csv ]));
0171 <span class="keyword">end</span>
0172 
0173 display(sprintf(<span class="string">'Result file directory %s'</span>,foptions.result_dir));
0174 
0175 <span class="keyword">if</span> length(foptions.result_file_csv),
0176   <span class="keyword">if</span> strcmp(foptions.result_file_csv(end-3:end),<span class="string">'.tsv'</span>), foptions.result_file_csv = foptions.result_file_csv(1:end-4); <span class="keyword">end</span>
0177   <span class="keyword">if</span> strcmp(foptions.result_file_csv(end-3:end),<span class="string">'.csv'</span>), foptions.result_file_csv = foptions.result_file_csv(1:end-4); <span class="keyword">end</span>
0178   cd(foptions.result_dir);
0179   load(foptions.result_file_matlab);
0180   <a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_save_data_table.html" class="code" title="function all = replicate_regression_save_data_table(data_table, rep_name, basename)">replicate_regression_save_data_table</a>(data_reg.average,<span class="string">'R1_R2_R3'</span>,[ foptions.result_file_csv <span class="string">'_average.csv'</span> ]);
0181   fn = fieldnames(data_reg.replicates);
0182   <span class="keyword">for</span> it=1:length(fn),
0183     <a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_save_data_table.html" class="code" title="function all = replicate_regression_save_data_table(data_table, rep_name, basename)">replicate_regression_save_data_table</a>(data_reg.replicates.(fn{it}),fn{it},[ foptions.result_file_csv <span class="string">'_replicate_'</span> fn{it} <span class="string">'.csv'</span>]);
0184   <span class="keyword">end</span>
0185 <span class="keyword">end</span>
0186 
0187 
0188 <span class="comment">% ------------------------------------------------</span>
0189 <span class="comment">% Store all results in zip file</span>
0190 
0191 <span class="keyword">if</span> length(foptions.result_file_zip), 
0192   display(<span class="string">'Generating zip file'</span>);
0193   eval(sprintf(<span class="string">'! cd %s; cd ..; rm %s'</span>,          foptions.data_dir, foptions.result_file_zip));
0194   eval(sprintf(<span class="string">'! cd %s; cd ..; zip %s %s'</span>,      foptions.data_dir, foptions.result_file_zip, foptions.data_dir));
0195   eval(sprintf(<span class="string">'! cd %s; cd ..; zip %s %s/*csv'</span>, foptions.data_dir, foptions.result_file_zip, foptions.data_dir));
0196   eval(sprintf(<span class="string">'! cd %s; cd ..; zip %s %s'</span>,      foptions.data_dir, foptions.result_file_zip, foptions.result_dir));
0197   eval(sprintf(<span class="string">'! cd %s; cd ..; zip %s %s/*csv'</span>, foptions.data_dir, foptions.result_file_zip, foptions.result_dir));
0198   eval(sprintf(<span class="string">'! cd %s; cd ..; zip -r %s %s'</span>,   foptions.data_dir, foptions.result_file_zip, foptions.graphics_dir));
0199 <span class="keyword">end</span>
0200 
0201 
0202 <span class="comment">% ------------------------------------------------</span>
0203 <span class="comment">% Make graphics and save them</span>
0204 
0205 <span class="keyword">if</span> length(foptions.graphics_file),
0206   display(sprintf(<span class="string">'Graphics directory %s'</span>,foptions.graphics_dir));
0207   cd(foptions.result_dir);
0208   load(foptions.result_file_matlab);
0209   cd(foptions.graphics_dir);
0210   <a href="../../.././replicate_regression/replicate_regression/replicate_regression/replicate_regression_display_statistics.html" class="code" title="function replicate_regression_display_statistics( result, options, filename,image_format)">replicate_regression_display_statistics</a>(data_reg, options_complete, foptions.graphics_file, foptions.graphics_format);
0211 <span class="keyword">end</span>
0212 
0213 <span class="keyword">if</span> length(foptions.graphics_individual),
0214   cd(foptions.result_dir);
0215   load(foptions.result_file_matlab);
0216   cd(foptions.graphics_dir);
0217   n_elements = size(data_reg.average.DataMean,1);
0218   ind_show   = 1:n_elements;
0219   clear gp; 
0220   gp.convenience_name   = foptions.convenience_name;
0221   gp.subplot            = [5,5]; 
0222   gp.log_transformation = foptions.log_transformation; 
0223   gp.replicate_names    = fieldnames(data_reg.replicates); 
0224   gp.fontsize           = 10;
0225   gp.mark_data          = data_reg.presumable_outliers;
0226   <span class="keyword">if</span> strcmp(foptions.data_scale,<span class="string">'absolute'</span>), 
0227     gp.logarithmic_data = 0; 
0228   <span class="keyword">else</span>,
0229     gp.logarithmic_data = 1; 
0230   <span class="keyword">end</span> 
0231   <span class="keyword">if</span> strcmp(foptions.graphics_scale,<span class="string">'log2'</span>),  
0232     gp.show_log2 = 1;
0233   <span class="keyword">else</span>,
0234     gp.show_log2 = 0;
0235   <span class="keyword">end</span>; 
0236   gp.image_format = foptions.graphics_format;
0237   <a href="../../.././replicate_regression/replicate_regression/utils/ca.html" class="code" title="function ca()">ca</a>;
0238   <a href="../../.././replicate_regression/replicate_regression/replicate_regression/biotable_interpolation_graphics_std.html" class="code" title="function biotable_interpolation_graphics_std(combined,averaged,replicate_averaged,p,ind_show,outfile);">biotable_interpolation_graphics_std</a>(data_reg.combined, data_reg.average, data_reg.replicates, gp, ind_show,foptions.graphics_individual);
0239   <span class="keyword">if</span> foptions.postprocess_normalise,
0240     <a href="../../.././replicate_regression/replicate_regression/utils/ca.html" class="code" title="function ca()">ca</a>;
0241     <a href="../../.././replicate_regression/replicate_regression/replicate_regression/biotable_interpolation_graphics_std.html" class="code" title="function biotable_interpolation_graphics_std(combined,averaged,replicate_averaged,p,ind_show,outfile);">biotable_interpolation_graphics_std</a>(data_reg.adjusted.combined, data_reg.adjusted.average, data_reg.adjusted.replicates, gp, ind_show,[foptions.graphics_individual <span class="string">'_adjusted'</span>]);
0242   <span class="keyword">end</span>
0243 <span class="keyword">end</span>
0244</pre></div>
<hr><address>Generated on Fri 13-Feb-2015 15:19:19 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>